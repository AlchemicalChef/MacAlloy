<!DOCTYPE html>
<html>
<head>
    <title>Alloy Model Validation Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        h3 {
            color: #7f8c8d;
        }
        .model-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-box {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }
        th {
            background: #3498db;
            color: white;
        }
        tr:hover {
            background: #f8f9fa;
        }
        .pass {
            color: #27ae60;
            font-weight: bold;
        }
        .fail {
            color: #e74c3c;
            font-weight: bold;
        }
        .warning {
            color: #f39c12;
            font-weight: bold;
        }
        .collapsible {
            background: #3498db;
            color: white;
            cursor: pointer;
            padding: 12px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1em;
            border-radius: 4px;
            margin: 5px 0;
        }
        .collapsible:hover {
            background: #2980b9;
        }
        .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f9f9f9;
            border-radius: 0 0 4px 4px;
        }
        .sig-list {
            font-family: monospace;
            font-size: 0.9em;
        }
        .check-result {
            display: inline-block;
            width: 20px;
            text-align: center;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .summary-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .test-results {
            background: #2ecc71;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .test-results.partial {
            background: #f39c12;
        }
        .test-results.failed {
            background: #e74c3c;
        }
    </style>
</head>
<body>
    <h1>üîê AD DACL Alloy Model Validation Report</h1>
    <p>Generated: 2025-12-09 08:05:42</p>
    
    <div class="summary-box">
        <h2 style="margin-top:0; color:white;">Executive Summary</h2>
        <p>This report validates the Active Directory DACL Alloy models against the MS-DTYP specification 
        and BloodHound attack path detection requirements.</p>
        <ul>
            <li><strong>Models Analyzed:</strong> 2</li>
            <li><strong>Total Signatures:</strong> 133</li>
            <li><strong>Total Predicates:</strong> 98</li>
            <li><strong>Syntax Errors:</strong> 0</li>
        </ul>
    </div>
    
    <div class="test-results">
        <h3 style="margin-top:0;">‚úÖ Python Reference Implementation Tests: 20/20 PASSED</h3>
        <p>All DACL evaluation algorithm tests pass, validating the model's semantic correctness.</p>
    </div>

    <div class="model-section">
        <h2>üìÑ ad_dacl_corrected.als</h2>
        <p><strong>Module:</strong> ad_dacl_corrected</p>
        
        <div class="stat-grid">
            <div class="stat-box">
                <div class="stat-number">61</div>
                <div class="stat-label">Signatures</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">51</div>
                <div class="stat-label">Predicates</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">3</div>
                <div class="stat-label">Functions</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">3</div>
                <div class="stat-label">Assertions</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">12</div>
                <div class="stat-label">Commands</div>
            </div>
            <div class="stat-box">
                <div class="stat-number pass">0</div>
                <div class="stat-label">Syntax Errors</div>
            </div>
        </div>
        
        <h3>DACL Semantics Coverage (9/10)</h3>
        <table>
            <tr>
                <th>Semantic Property</th>
                <th>Description</th>
                <th>Status</th>
            </tr>

            <tr>
                <td><code>null_dacl_grants_all</code></td>
                <td>NULL DACL (or missing DACL) grants all access</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>empty_dacl_denies</code></td>
                <td>Empty DACL denies all access except implicit owner rights</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>deny_before_allow</code></td>
                <td>Deny ACEs are evaluated before Allow ACEs (canonical order)</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>deny_immediate_termination</code></td>
                <td>Deny ACE causes immediate access denial</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>allow_accumulation</code></td>
                <td>Allow ACEs accumulate granted rights</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>inherit_only_skipped</code></td>
                <td>INHERIT_ONLY ACEs are skipped during access check</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>implicit_owner_rights</code></td>
                <td>Owner gets implicit READ_CONTROL + WRITE_DAC</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>object_specific_matching</code></td>
                <td>Object-specific ACEs match on GUID</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>sid_in_token</code></td>
                <td>SID matching checks user SID and group memberships</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>deny_only_sid</code></td>
                <td>Deny-only SIDs only match deny ACEs</td>
                <td class="warning">‚ö†Ô∏è</td>
            </tr>

        </table>
        
        <button class="collapsible">üìã Signatures (61 total)</button>
        <div class="content">
            <table>
                <tr><th>Name</th><th>Modifiers</th><th>Extends</th></tr>
<tr><td><code>SID</code></td><td>abstract</td><td>-</td></tr>
<tr><td><code>Everyone</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>AuthenticatedUsers</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>PrincipalSelf</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>CreatorOwner</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>CreatorGroup</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>OwnerRights</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>DomainAdminsSID</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>EnterpriseAdminsSID</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>DomainUsersSID</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>UserPrincipal</code></td><td>-</td><td>SID</td></tr>
<tr><td><code>GroupPrincipal</code></td><td>-</td><td>SID</td></tr>
<tr><td><code>ComputerPrincipal</code></td><td>-</td><td>SID</td></tr>
<tr><td><code>AccessRight</code></td><td>abstract</td><td>-</td></tr>
<tr><td><code>DELETE</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>READ_CONTROL</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>WRITE_DAC</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>WRITE_OWNER</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_CREATE_CHILD</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_DELETE_CHILD</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_LIST_CONTENTS</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_SELF</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_READ_PROPERTY</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_WRITE_PROPERTY</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_DELETE_TREE</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_LIST_OBJECT</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_CONTROL_ACCESS</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>ACEType</code></td><td>abstract</td><td>-</td></tr>
<tr><td><code>ACCESS_ALLOWED</code></td><td>one</td><td>ACEType</td></tr>
<tr><td><code>ACCESS_DENIED</code></td><td>one</td><td>ACEType</td></tr>
<tr><td colspan='3'><em>... and 31 more</em></td></tr>

            </table>
        </div>
        
        <button class="collapsible">üîß Predicates (51 total)</button>
        <div class="content">
            <div class="sig-list">
<code>pred hasInheritOnly[a: ACE]</code><br>
<code>pred isInheritedACE[a: ACE]</code><br>
<code>pred hasContainerInherit[a: ACE]</code><br>
<code>pred hasObjectInherit[a: ACE]</code><br>
<code>pred isDACLNull[d: DACL]</code><br>
<code>pred isDACLProtected[d: DACL]</code><br>
<code>pred daclIsPresent[sd: SecurityDescriptor]</code><br>
<code>pred hasAdminCount[obj: ADObject]</code><br>
<code>pred hasSPNSet[obj: ADObject]</code><br>
<code>pred isUnconstrainedDelegation[obj: ADObject]</code><br>
<code>pred wasExplicitlyDenied[r: AccessCheckResult]</code><br>
<code>pred sidInToken[token: AccessToken, sid: SID]</code><br>
<code>pred sidMatchesForAllow[token: AccessToken, sid: SID]</code><br>
<code>pred sidMatchesForDeny[token: AccessToken, sid: SID]</code><br>
<code>pred isDenyACE[a: ACE]</code><br>
<code>pred isAllowACE[a: ACE]</code><br>
<code>pred isObjectACE[a: ACE]</code><br>
<code>pred isStandardACE[a: ACE]</code><br>
<code>pred aceIsEffective[a: ACE]</code><br>
<code>pred objectTypeMatches[ace: ACE, requestedRights: set AccessRight]</code><br>
<code>pred aceApplies[ace: ACE, token: AccessToken, requestedRights: set AccessRight]</code><br>
<code>pred ownerHasExplicitACEs[sd: SecurityDescriptor]</code><br>
<code>pred evaluateDACL[sd: SecurityDescriptor, token: AccessToken, requestedRights: set AccessRight, result: AccessCheckResult]</code><br>
<code>pred sameInheritanceLevel[a1, a2: ACE]</code><br>
<code>pred sameACECategory[a1, a2: ACE]</code><br>
<code>pred canonicalOrder[dacl: DACL]</code><br>
<code>pred nonCanonicalDACL[dacl: DACL]</code><br>
<code>pred hasGenericAll[attacker: SID, target: ADObject]</code><br>
<code>pred hasGenericWrite[attacker: SID, target: ADObject]</code><br>
<code>pred hasWriteDacl[attacker: SID, target: ADObject]</code><br>
<code>pred hasWriteOwner[attacker: SID, target: ADObject]</code><br>
<code>pred hasForceChangePassword[attacker: SID, target: ADObject]</code><br>
<code>pred hasAllExtendedRights[attacker: SID, target: ADObject]</code><br>
<code>pred hasDCSync[attacker: SID, domain: ADObject]</code><br>
<code>pred hasAddMember[attacker: SID, group: ADObject]</code><br>
<code>pred hasAddAllowedToAct[attacker: SID, computer: ADObject]</code><br>
<code>pred hasShadowCredentials[attacker: SID, target: ADObject]</code><br>
<code>pred hasTargetedKerberoast[attacker: SID, target: ADObject]</code><br>
<code>pred nullDACLVulnerability[obj: ADObject]</code><br>
<code>pred overlyPermissiveACE[obj: ADObject]</code><br>
<em>... and 11 more</em><br>

            </div>
        </div>
        
        <button class="collapsible">‚ñ∂Ô∏è Commands (12 total)</button>
        <div class="content">
            <table>
                <tr><th>Type</th><th>Target</th><th>Scope</th></tr>
<tr><td>run</td><td><code>testDenyBlocks</code></td><td>5 but 3 ACE, 1 DACL, 1 SecurityDescriptor,</td></tr>
<tr><td>run</td><td><code>testEmptyDACLDenies</code></td><td>4 but 0 ACE, 1 DACL, 1 SecurityDescriptor,</td></tr>
<tr><td>run</td><td><code>testNullDACLGrants</code></td><td>4 but 0 ACE, 1 DACL, 1 SecurityDescriptor,</td></tr>
<tr><td>run</td><td><code>testImplicitOwnerRights</code></td><td>4 but 0 ACE, 1 DACL, 1 SecurityDescriptor,</td></tr>
<tr><td>run</td><td><code>findDCSyncMisconfig</code></td><td>6 but 4 ACE, 1 DACL, 2 ADObject</td></tr>
<tr><td>run</td><td><code>findEscalationPath</code></td><td>5 but 3 ACE, 1 DACL, 2 ADObject</td></tr>
<tr><td>run</td><td><code>findOverlyPermissive</code></td><td>5 but 3 ACE, 1 DACL, 2 ADObject</td></tr>
<tr><td>run</td><td><code>nonCanonicalDACL</code></td><td>5 but 4 ACE, 1 DACL</td></tr>
<tr><td>run</td><td><code>nullDACLVulnerability</code></td><td>4 but 1 ADObject</td></tr>
<tr><td>check</td><td><code>denyPrecedence</code></td><td>5 but 4 ACE, 1 DACL</td></tr>
<tr><td>check</td><td><code>ownerGetsImplicitRights</code></td><td>4 but 1 ACE, 1 DACL</td></tr>
<tr><td>check</td><td><code>nullDACLGrantsAll</code></td><td>4 but 0 ACE, 1 DACL</td></tr>

            </table>
        </div>
</div>

    <div class="model-section">
        <h2>üìÑ ad_dacl_v2.als</h2>
        <p><strong>Module:</strong> ad_dacl_v2</p>
        
        <div class="stat-grid">
            <div class="stat-box">
                <div class="stat-number">72</div>
                <div class="stat-label">Signatures</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">47</div>
                <div class="stat-label">Predicates</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">4</div>
                <div class="stat-label">Functions</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">1</div>
                <div class="stat-label">Assertions</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">9</div>
                <div class="stat-label">Commands</div>
            </div>
            <div class="stat-box">
                <div class="stat-number pass">0</div>
                <div class="stat-label">Syntax Errors</div>
            </div>
        </div>
        
        <h3>DACL Semantics Coverage (8/10)</h3>
        <table>
            <tr>
                <th>Semantic Property</th>
                <th>Description</th>
                <th>Status</th>
            </tr>

            <tr>
                <td><code>null_dacl_grants_all</code></td>
                <td>NULL DACL (or missing DACL) grants all access</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>empty_dacl_denies</code></td>
                <td>Empty DACL denies all access except implicit owner rights</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>deny_before_allow</code></td>
                <td>Deny ACEs are evaluated before Allow ACEs (canonical order)</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>deny_immediate_termination</code></td>
                <td>Deny ACE causes immediate access denial</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>allow_accumulation</code></td>
                <td>Allow ACEs accumulate granted rights</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>inherit_only_skipped</code></td>
                <td>INHERIT_ONLY ACEs are skipped during access check</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>implicit_owner_rights</code></td>
                <td>Owner gets implicit READ_CONTROL + WRITE_DAC</td>
                <td class="warning">‚ö†Ô∏è</td>
            </tr>

            <tr>
                <td><code>object_specific_matching</code></td>
                <td>Object-specific ACEs match on GUID</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>sid_in_token</code></td>
                <td>SID matching checks user SID and group memberships</td>
                <td class="pass">‚úÖ</td>
            </tr>

            <tr>
                <td><code>deny_only_sid</code></td>
                <td>Deny-only SIDs only match deny ACEs</td>
                <td class="warning">‚ö†Ô∏è</td>
            </tr>

        </table>
        
        <button class="collapsible">üìã Signatures (72 total)</button>
        <div class="content">
            <table>
                <tr><th>Name</th><th>Modifiers</th><th>Extends</th></tr>
<tr><td><code>SID</code></td><td>abstract</td><td>-</td></tr>
<tr><td><code>Everyone</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>AuthenticatedUsers</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>PrincipalSelf</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>CreatorOwner</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>CreatorGroup</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>OwnerRights</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>DomainAdminsSID</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>EnterpriseAdminsSID</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>DomainUsersSID</code></td><td>one</td><td>SID</td></tr>
<tr><td><code>UserPrincipal</code></td><td>-</td><td>SID</td></tr>
<tr><td><code>GroupPrincipal</code></td><td>-</td><td>SID</td></tr>
<tr><td><code>ComputerPrincipal</code></td><td>-</td><td>SID</td></tr>
<tr><td><code>AccessRight</code></td><td>abstract</td><td>-</td></tr>
<tr><td><code>DELETE</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>READ_CONTROL</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>WRITE_DAC</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>WRITE_OWNER</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_CREATE_CHILD</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_DELETE_CHILD</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_LIST_CONTENTS</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_SELF</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_READ_PROPERTY</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_WRITE_PROPERTY</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_DELETE_TREE</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_LIST_OBJECT</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>DS_CONTROL_ACCESS</code></td><td>one</td><td>AccessRight</td></tr>
<tr><td><code>ACEType</code></td><td>abstract</td><td>-</td></tr>
<tr><td><code>ACCESS_ALLOWED</code></td><td>one</td><td>ACEType</td></tr>
<tr><td><code>ACCESS_DENIED</code></td><td>one</td><td>ACEType</td></tr>
<tr><td colspan='3'><em>... and 42 more</em></td></tr>

            </table>
        </div>
        
        <button class="collapsible">üîß Predicates (47 total)</button>
        <div class="content">
            <div class="sig-list">
<code>pred hasObjectInherit[a: ACE]</code><br>
<code>pred hasContainerInherit[a: ACE]</code><br>
<code>pred hasNoPropagateInherit[a: ACE]</code><br>
<code>pred hasInheritOnly[a: ACE]</code><br>
<code>pred isInherited[a: ACE]</code><br>
<code>pred isDACLNull[d: DACL]</code><br>
<code>pred isDACLProtected[d: DACL]</code><br>
<code>pred hasDACL[sd: SecurityDescriptor]</code><br>
<code>pred hasAdminCount[obj: ADObject]</code><br>
<code>pred hasSPNSet[obj: ADObject]</code><br>
<code>pred isUnconstrainedDelegation[obj: ADObject]</code><br>
<code>pred sidInToken[token: AccessToken, sid: SID]</code><br>
<code>pred sidInTokenForAllow[token: AccessToken, sid: SID]</code><br>
<code>pred sidInTokenForDeny[token: AccessToken, sid: SID]</code><br>
<code>pred isDenyACE[ace: ACE]</code><br>
<code>pred isAllowACE[ace: ACE]</code><br>
<code>pred isObjectACE[ace: ACE]</code><br>
<code>pred isStandardACE[ace: ACE]</code><br>
<code>pred aceIsEffective[ace: ACE]</code><br>
<code>pred objectTypeApplies[ace: ACE, requestedRights: set AccessRight]</code><br>
<code>pred aceApplies[ace: ACE, token: AccessToken, requestedRights: set AccessRight]</code><br>
<code>pred evaluateDACL[sd: SecurityDescriptor, token: AccessToken, requestedRights: set AccessRight, result: AccessCheckResult]</code><br>
<code>pred noOwnerACEs[sd: SecurityDescriptor]</code><br>
<code>pred canonicalOrder[dacl: DACL]</code><br>
<code>pred nonCanonicalDACL[dacl: DACL]</code><br>
<code>pred hasGenericAll[attacker: SID, target: ADObject]</code><br>
<code>pred hasGenericWrite[attacker: SID, target: ADObject]</code><br>
<code>pred hasWriteDacl[attacker: SID, target: ADObject]</code><br>
<code>pred hasWriteOwner[attacker: SID, target: ADObject]</code><br>
<code>pred hasForceChangePassword[attacker: SID, target: ADObject]</code><br>
<code>pred hasAllExtendedRights[attacker: SID, target: ADObject]</code><br>
<code>pred hasDCSync[attacker: SID, domain: ADObject]</code><br>
<code>pred hasAddMember[attacker: SID, group: ADObject]</code><br>
<code>pred hasAddAllowedToAct[attacker: SID, computer: ADObject]</code><br>
<code>pred hasShadowCredentials[attacker: SID, target: ADObject]</code><br>
<code>pred hasTargetedKerberoast[attacker: SID, target: ADObject]</code><br>
<code>pred nullDACLVulnerability[obj: ADObject]</code><br>
<code>pred overlyPermissiveACE[obj: ADObject]</code><br>
<code>pred adminSDHolderBackdoor[adminSDHolder: ADObject, attacker: SID]</code><br>
<code>pred certTemplateWritable[template: ADObject, attacker: SID]</code><br>
<em>... and 7 more</em><br>

            </div>
        </div>
        
        <button class="collapsible">‚ñ∂Ô∏è Commands (9 total)</button>
        <div class="content">
            <table>
                <tr><th>Type</th><th>Target</th><th>Scope</th></tr>
<tr><td>run</td><td><code>testDenyBlocks</code></td><td>5 but 3 ACE, 1 DACL</td></tr>
<tr><td>run</td><td><code>testEmptyDACLDenies</code></td><td>4 but 0 ACE, 1 DACL</td></tr>
<tr><td>run</td><td><code>testNullDACLGrants</code></td><td>4 but 0 ACE, 1 DACL</td></tr>
<tr><td>run</td><td><code>findDCSyncMisconfig</code></td><td>6 but 4 ACE, 1 DACL, 2 ADObject</td></tr>
<tr><td>run</td><td><code>findEscalationPath</code></td><td>5 but 3 ACE, 1 DACL, 2 ADObject</td></tr>
<tr><td>run</td><td><code>nullDACLVulnerability</code></td><td>4 but 1 ADObject</td></tr>
<tr><td>run</td><td><code>overlyPermissiveACE</code></td><td>5 but 3 ACE, 2 ADObject</td></tr>
<tr><td>run</td><td><code>nonCanonicalDACL</code></td><td>5 but 4 ACE, 1 DACL</td></tr>
<tr><td>check</td><td><code>denyPrecedence</code></td><td>5 but 4 ACE, 1 DACL</td></tr>

            </table>
        </div>
</div>

    <div class="model-section">
        <h2>ü©∏ BloodHound Attack Path Coverage</h2>
        <p>The model implements detection for the following BloodHound edge types:</p>
        <table>
            <tr><th>Edge Type</th><th>Description</th><th>Attack Scenario</th></tr>
            <tr><td><code>hasGenericAll</code></td><td>Full control over object</td><td>Complete object takeover</td></tr>
            <tr><td><code>hasGenericWrite</code></td><td>Write all properties</td><td>Attribute manipulation</td></tr>
            <tr><td><code>hasWriteDacl</code></td><td>Modify DACL</td><td>Permission escalation</td></tr>
            <tr><td><code>hasWriteOwner</code></td><td>Take ownership</td><td>Implicit GenericAll</td></tr>
            <tr><td><code>hasForceChangePassword</code></td><td>Reset user password</td><td>Account takeover</td></tr>
            <tr><td><code>hasAllExtendedRights</code></td><td>All extended rights</td><td>Multiple attack vectors</td></tr>
            <tr><td><code>hasDCSync</code></td><td>Replication rights</td><td>Credential extraction</td></tr>
            <tr><td><code>hasAddMember</code></td><td>Add group members</td><td>Privilege escalation</td></tr>
            <tr><td><code>hasAddAllowedToAct</code></td><td>Configure RBCD</td><td>Kerberos delegation abuse</td></tr>
            <tr><td><code>hasShadowCredentials</code></td><td>Modify KeyCredentialLink</td><td>Certificate-based auth</td></tr>
            <tr><td><code>hasTargetedKerberoast</code></td><td>Set SPN on user</td><td>Kerberoasting attack</td></tr>
        </table>
    </div>
    
    <div class="model-section">
        <h2>üìö References</h2>
        <ul>
            <li>MS-DTYP Section 2.4.3: ACCESS_MASK structure</li>
            <li>MS-DTYP Section 2.4.4.1: ACE_HEADER structure</li>
            <li>MS-DTYP Section 2.4.5: ACL canonical form</li>
            <li>MS-DTYP Section 2.5.3.2: AccessCheck algorithm</li>
            <li>MS-ADTS Section 5.1.3.2: AD-specific access rights</li>
            <li>MS-ADTS Section 5.1.3.3.3: Object-specific access check</li>
            <li>BloodHound attack path taxonomy</li>
            <li>"An ACE Up the Sleeve" (Schroeder & Robbins, Black Hat 2017)</li>
        </ul>
    </div>
    
    <script>
        var coll = document.getElementsByClassName("collapsible");
        for (var i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        }
    </script>
</body>
</html>
